{% extends "base.html" %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css">
<link rel="stylesheet" href="{% static '/styles/mainformissing.css' %}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<main>
    <!-- Hero Section (Главная секция) -->
    <section id="home" class="hero">
        <div class="hero-content">
            <h1 data-aos="fade-up">Поможем найти пропавших людей</h1>
            <p data-aos="fade-up" data-aos-delay="200">Каждая минута важна. Вместе мы можем помочь найти тех, кто пропал.</p>
        </div>
        <div class="search-box" data-aos="fade-up" data-aos-delay="400">
            <form method="GET" action="{% url 'missing_person_list' %}">
                <div class="date-filters">
                    <div class="date-input">
                        <label for="dateFrom">Дата с:</label>
                        <input type="date" name="date_from" id="dateFrom" value="{{ request.GET.date_from }}">
                    </div>
                    <div class="date-input">
                        <label for="dateTo">Дата по:</label>
                        <input type="date" name="date_to" id="dateTo" value="{{ request.GET.date_to }}">
                    </div>
                    <button type="submit" class="search-btn">
                        <i class="fas fa-search"></i>
                        Фильтровать
                    </button>
                </div>
            </form>
        </div>
    </section>
    

    <!-- Пропавшие люди (Missing Persons) -->
    <section id="missing-persons" class="missing-persons">
        <h2 data-aos="fade-up">Пропавшие люди</h2>
        <div class="persons-grid">
            {% for person in missing_people %}
                <div class="person-card" data-aos="fade-up">
                    <div class="person-image">
                        <div class="image-placeholder">
                            <i class="fas fa-user"></i>
                        </div>
                    </div>
                    <div class="person-info">
                        <h3>{{ person.name }}</h3>
                        <ul>
                            <li><i class="fas fa-user"></i> Возраст: {{ person.age }}</li>
                            <li><i class="fas fa-venus-mars"></i> Пол: {{ person.get_gender_display }}</li>
                            <li><i class="fas fa-calendar"></i> Дата пропажи: {{ person.reported_time|date:"d.m.Y H:i" }}</li>
                        </ul>
                        <p class="description">{{ person.description }}</p>
                        <div class="actions">
                            <a href="{% url "view_missing_person"  person.id%}", class="map-btn">
                                <button class="map-btn">
                                    <i class="fas fa-map-marker-alt"></i>
                                    Посмотреть на карте
                                </button>
                            </a>
                            <button class="share-btn">
                                <i class="fas fa-share-alt"></i>
                                Поделиться
                            </button>
                        </div>
                    </div>
                </div>
            {% empty %}
                <p class="no-missing-people">Нет пропавших людей по выбранной дате.</p>
            {% endfor %}
        </div>
    </section>

    <!-- Пагинация (Pagination) -->
    <div class="pagination">
        {% if missing_people.has_previous %}
            <a href="?page=1&date_from={{ request.GET.date_from }}&date_to={{ request.GET.date_to }}">« Первая</a>
            <a href="?page={{ missing_people.previous_page_number }}&date_from={{ request.GET.date_from }}&date_to={{ request.GET.date_to }}">«</a>
        {% endif %}
        <span>Страница {{ missing_people.number }} из {{ missing_people.paginator.num_pages }}</span>
        {% if missing_people.has_next %}
            <a href="?page={{ missing_people.next_page_number }}&date_from={{ request.GET.date_from }}&date_to={{ request.GET.date_to }}">»</a>
            <a href="?page={{ missing_people.paginator.num_pages }}&date_from={{ request.GET.date_from }}&date_to={{ request.GET.date_to }}">Последняя »</a>
        {% endif %}
    </div>
</main>

<script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12"></script>
<script type="module" src="{% static '/js/mainformissinig.js' %}"></script>

<script>
    AOS.init();
    var swiper = new Swiper('.swiper-container', {
        loop: true,
        navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev'
        }
    });
</script>

{% endblock content %}
